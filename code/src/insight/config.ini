[INSIGHT]
AMOUNT_COUNT_QUERY = SELECT {amount_field}, ML_Prediction FROM {table_name}
RISK_PATTERN_REPORT = SELECT Module, SubModule, PatternID, PatternDescriptionLong, KRI, TestedCount, FailedCount, [FailedCount_%%] AS FailedCount_Percent FROM Model.Patterns WHERE TestedCount > 0 AND FailedCount > 0 AND IsEnabled = 1



#CONCERN_REPORT_QUERY = WITH ConcernIDs AS (SELECT DISTINCT AD.SPT_ROWID AS SPT_RowID, AH.Module, AH.Submodule, AD.UDMTable, QR.[QuestionnaireAssID] AS QTAID, QR.ResponseText, QT.QuestionnaireText, 'Concern' as ClosedAs FROM App.AlertHeader AS AH INNER JOIN ref.StatusLookup AS SL ON SL.[StatuslookupId] = AH.AlertState INNER JOIN App.AlertDetails AS AD ON AD.[AlertId] = AH.AlertId INNER JOIN App.[QuestionnaireResponse] AS QR ON QR.[AlertId] = AH.AlertId INNER JOIN App.[QuestionnaireTemplateAssociation] AS QTA ON QTA.[QuestionnaireTemplateAssociationID] = QR.[QuestionnaireAssID] INNER JOIN App.Questionnaire AS QT ON QT.[QuestionnaireID] = QTA.QuestionnaireID WHERE AH.IsSoftDelete = 0 AND QR.IsActive = 1 AND QTA.IsActive = 1 AND QT.IsActive = 1 AND RenderTypeID in (4, 6) AND AH.Module = '{Module}' AND AH.Submodule = '{SubModule}') SELECT A.{AmountColumn} AS Total_Concern_Amount, A.Tests_Failed, A.Tests_Failed_Count, B.* FROM {SPT_BaseTable} AS A INNER JOIN ConcernIDs AS B ON B.SPT_RowID = A.SPT_RowID WHERE A.Tests_Failed_Count > 0 ORDER BY A.Tests_Failed_Count DESC


CONCERN_REPORT_QUERY = WITH ConcernIDs AS (SELECT DISTINCT AD.SPT_ROWID AS SPT_ROWID, AH.Module, AH.Submodule, AD.UDMTable, QR.[QuestionnaireAssID] AS QTAID, QR.ResponseText, QT.QuestionnaireText, 'Concern' as ClosedAs FROM App.AlertHeader AS AH INNER JOIN ref.StatusLookup AS SL ON SL.[StatuslookupId] = AH.AlertState INNER JOIN App.AlertDetails AS AD ON AD.[AlertId] = AH.AlertId INNER JOIN App.[QuestionnaireResponse] AS QR ON QR.[AlertId] = AH.AlertId INNER JOIN App.[QuestionnaireTemplateAssociation] AS QTA ON QTA.[QuestionnaireTemplateAssociationID] = QR.[QuestionnaireAssID] INNER JOIN App.Questionnaire AS QT ON QT.[QuestionnaireID] = QTA.QuestionnaireID WHERE AH.IsSoftDelete = 0 AND QR.IsActive = 1 AND QTA.IsActive = 1 AND QT.IsActive = 1 AND QT.RenderTypeID in (4, 6) AND AH.Module = '{Module}' AND AH.Submodule = '{SubModule}') SELECT A.{AmountColumn} AS Total_Concern_Amount, A.Tests_Failed, A.Tests_Failed_Count, B.* FROM {SPT_BaseTable} AS A INNER JOIN ConcernIDs AS B ON B.SPT_ROWID = A.SPT_ROWID WHERE A.Tests_Failed_Count > 0 ORDER BY A.Tests_Failed_Count DESC
